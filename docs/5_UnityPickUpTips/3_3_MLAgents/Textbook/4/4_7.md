# 模倣学習

「模倣学習」は、教師となる人間の一連の行動（「デモ」と呼びます）を模倣することで、タスクを攻略する学習法です。報酬を得ることが難しいゲームでも、人間の行動を模倣することで、学習を早く進めることができます。

## 模倣学習の学習環境の準備

「4-6 Curiosity」で作成した学習環境で「模倣学習」を学習します

## デモの記録
### ①エージェントに「DemonstrationRecorder」

RecordをチェックしてUnityエディタを実行すると、「Demonstration Directory」でデモの保存先を指定できます。デフォルトでは「Assets/Demonstrations/」

<img src="images/4_.png" width="90%" alt="" title="">

|項目|説明|
|---|---|
|Record|デモファイルを保存するかどうか|
|Num Steps To Record|記録するステップ数(0は無制限)|
|Demonstration Name|デモファイル名|
|Demonstration Directory|デモファイルを保存するフォルダ(デフォルトは「Demonstrations/」)|

<br>

### ②「Unityエディタ」上で、ヒューリスティックモードで実行


### ③キー操作で５周回った後、Stopボタンで終了

### ④ProjectWindowで「ImitationEx.demo」を選択


## 模倣学習の学習設定ファイルの設定
今回は「PPO」で学習します。以下のように、ハイパーパラメータを設定
```yaml
behaviors:
  ImitationEx:
    trainer_type: ppo

    max_steps: 10000000
    time_horizon: 128
    summary_freq: 10000
    keep_checkpoints: 5

    hyperparameters:
      batch_size: 128
      buffer_size: 2048
      learning_rate: 0.0003
      learning_rate_schedule: linear

      beta: 0.01
      epsilon: 0.2
      lambd: 0.95
      num_epoch: 3

    network_settings:
      normalize: false
      hidden_units: 512
      num_layers: 2

    reward_signals:
      extrinsic:
        gamma: 0.99
        strength: 1.0

      curiosity:
        gamma: 0.99
        strength: 0.005
        network_settings:
          hidden_units: 64
        learning_rate: 0.0003

      gail:
        gamma: 0.99
        strength: 0.005
        network_settings:
          hidden_units: 64
        learning_rate: 0.0003
        use_actions: false
        use_vail: false
        demo_path: ./config/sample/ImitationEx.demo

    behavioral_cloning:
      demo_path: ./config/sample/ImitationEx.demo
      steps: 10000
      strength: 0.5
      samples_per_update: 0
```

### BCのハイパーパラメータ
「behavioral_cloning:」に、BCのパラメータを設定します

**`demo_path`**  
demoファイルのパス

**``**



**``**


**``**


**``**


**``**



### GAILのハイパーパラメータ

**``**

**``**

**``**

**``**

**``**

**``**


**``**



## GANのGeneratorとDiscriminator
「」は、「」


## 模倣学習の実行
「」を実行します。デモファイルは、

```
mlagents-learn 
```

## 模倣学習専用のグラフ


#### Pretraining Lossグラフ



#### GAIL Lossグラフ




#### GAIL Rewardグラフ



#### GAIL Policy Estimateグラフ


#### GAIL Value Estimateグラフ


#### GAIL Expert Estimateグラフ



<br>

## 模倣学習の「あり」と「なし」の比較

「模倣学習」の「あり」「なし」


