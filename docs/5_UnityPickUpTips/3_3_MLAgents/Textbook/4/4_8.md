# LSTM(Long Short-Term Memory)

「LSTM」(Long Short-Term Memory)は、時系列を扱えるニューラルネットワークです。強化学習では、通常「現在の環境」の観察に応じて「エージェント」が「行動」を決定しますが、「LSTM」を利用することで環境の過去の観察も「行動」決定の判断材料に使えます。つまり、「エージェント」に「記憶」を持たせることができるようになります。  
「LSTM」はContinuousではうまく機能しません。より良い結果を得るには、「Discrete」を使用してください。

# LSTMの学習環境の準備

「4-4 RaycastObservation」で作成した学習環境をカスタマイズして、ボードと同じ色のターゲットまで移動することを学ぶ学習環境を作成し、「LSTM」で学習します。  
ターゲットを見ている時はボードが見えないため、「LSTM」でボードの色を覚えないと、報酬が増えない環境になっています。


<img src="images/4_.png" width="90%" alt="" title="">



|項目|説明|
|---|---|
|観察|・Vector Observation(サイズ2)<br>0:RollerAgentのX速度<br>1:RollerAgentのZ速度<br>・Raycast Observation(スタック2)|
|行動|・Discrete(サイズ1)<br>0:移動(0:,1:,2:,3:,4:)|
|報酬|・ステップ毎:-0.0005<br>・ボードの色と同じ色のターゲットに到達した時に +1.0(エピソード完了)<br>・ボードの色と違う色のターゲットに到達した時に -0.2(エピソード完了)|
|決定|・5ステップ毎


`RaycastAgent.cs`
```cs

```

# LSTMの学習設定ファイルの設定

`LstmEx.yaml`
```yaml

```



